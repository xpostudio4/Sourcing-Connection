

{% extends "base.html" %}

{% block title %}{{ company.name  }}{% endblock %}
{% block external %}
    <script src="{{ STATIC_URL}}colorbox/jquery.colorbox-min.js"></script>
    <link rel="stylesheet" href="{{ STATIC_URL}}colorbox/colorbox.css" /> 
    <script>
        jQuery(document).ready(function () {
            jQuery('a.gallery').colorbox({ opacity:0.5 , rel:'group1' });
        });
    </script>
    <script>
       $(document).ready(function(){

        //A list of all the classes and Id's of the elements to be treated as read only tags.
        var tag_ids  = ['#company-product','#company-certification', '#company-industries', '#company-customers', '#company-offices', '#company-tags', '#company-applications', '#company-technologies']; 



        //for(i in tag_ids){

            //Create read only tags for the degrees field
            //var degrees =  $(this).find(tag_ids[i]).html().split(",");
            //var string_degrees = ""; 


            //for( j  in degrees){
            //  string_degrees += "<code>" + degrees[j] + "</code>  ";
            //}

            //$(tag_ids[i]).html(string_degrees);

        //}
        //Obtain twitter name and prettify it for the profile
//        var twitter_name  = $(this).find('#company-twitter-url').text().split("/").pop();
//            $('#company-twitter-url').text("@"+twitter_name);
            
            
       
        //Obtain the facebook profile name.
//        var facebook_name  = $(this).find('#company-facebook-url').text().split("/").pop();
//        $('#company-facebook-url').text(facebook_name)


       })
</script>
{% endblock %}

{% block content %}
<br/>
        {% if percentage_profile %}
            <h2 class="pagination-centered">Profile {{ percentage_profile.percentage }}% complete</h2>
            <div class="percentage-box ">
                
               <div class="progress span5">

                    <div class="bar" style="width: {{ percentage_profile.percentage }}%;"></div>
               </div>
            </div>



        {% endif %}
        <br/>


        {% if  user.is_staff or user.is_superuser or permission %}
            
                <div class="pull-right" style="margin-right:80px;">
                    <button type="button" class="btn btn-primary" data-toggle="button" ONCLICK="window.location.href='/company/{{ company.slug }}/update'">  Edit  </button>
                    <button type="button" class="btn btn-primary" data-toggle="button" ONCLICK="window.location.href='/company/{{ company.slug }}/links/update'">  Edit Links </button>
                </div>
         
        {% endif %}
<br/>
        
        <div class="media">
            <a class="pull-left" href="#">
                {% if company.logo %}
    
                <img class="img-polaroid" data-src="holder.js/64x64" src="{{ MEDIA_URL }}{{ company.logo }}" height="130", width="178">
                {% else %}
                <img class="img-polaroid" data-src="holder.js/64x64" src="{{ STATIC_URL }}images/no_logo.png" height=96, width=140  >
                
                {% endif %}
            </a>
        <div class="pull-right" style="margin-right:80px;"> 
        <div class="btn-group">
            <button class="btn">Follow</button>
                <button class="btn dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li><a tabindex="-1" href="#">Contact Company</a></li>
                <li><a tabindex="-1" href="#">Foll ow Blog</a></li>
                <li class="divider"></li>
                <li><a tabindex="-1" href="#">Something else here</a></li>
            </ul>
         </div>
        </div>
     <div class="media">
        <h2 class="media-heading">{{ company.name  }} </h2>
        <p class="muted" data-model="Company" data-url="/formfields/Company/{{ company.id }}/value_proposition/" data-pk="{{ company.id }}"  data-title="Value Proposition " id="company-value-proposition" data-type="textarea" > {{ company.value_proposition  }}</p>

    </div>

    <div class="span10">



        <div class="media">
            <h4 class="media-heading"><strong class="muted">Company Description:</strong></h4>
            <p id="company-description" data-model="Company" data-url="/formfields/Company/{{ company.id }}/description/" data-pk="{{ company.id }}"  data-title="Company Description" data-type="textarea"> {{ company.description  }}</p>
        </div>

    <div class="media">
<table class="table">
    <tbody>
        {% for link in companylinks %}
            <tr>
                <td>Company Link:</td>
                <td><a id="company-url" data-model="CompanyLink" data-url="/formfields/CompanyLink/{{ link.id }}/web_url/" data-pk="{{ link.id }}" data-title="Company Link" data-type="url" href="{{ link.web_url }}">{{ link.web_url }}</a></td>
                <td>Company Blog:</td>
                <td><a data-model="CompanyLink" data-url="/formfields/CompanyLink/{{ link.id }}/blog_url/" data-pk="{{ link.id }}" data-title="Company Blog URL" data-type="url" id="company-blog-url" href="{{ link.blog_url  }}">{{ link.blog_url  }}</a></td>
            </tr>
            <tr>
                <td>Twitter:</td>
                <td ><a data-model="CompanyLink" data-url="/formfields/CompanyLink/{{ link.id }}/twitter_url/" data-pk="{{ link.id }}" data-title="Company Twitter" data-type="url" id = "company-twitter-url" href="{{ link.twitter_url  }} ">{{ link.twitter_url  }}</a></td>

                <td>Facebook:</td>
                <td ><a data-model="CompanyLink" data-url="/formfields/CompanyLink/{{ link.id }}/facebook_link/" href="{{ link.facebook_url  }}" data-title="Company facebook" id="company-facebook-url" data-type="url" href="{{ link.facebook_link  }}" >{{ link.facebook_link  }}</a></td>
            </tr>
        {% endfor%}

        {% if  user.is_staff or user.is_superuser or permission %}
        <tr>
            <td>Email: </td>
                <td><a data-model="Company" data-url="/formfields/Company/{{ company.id }}/email/" data-pk="{{ company.id }}" data-title="Company Description"  id="company-email" data-type="email" href="mailto:{{ company.email  }}">{{ company.email  }} </a></td>

            <td>Phone Contact:</td>
                <td><a data-type="tel" data-model="Company" data-url="/formfields/Company/{{ company.id }}/main_phone/" data-pk="{{ company.id }}"  data-title="Company Main Phone"  id="company-phone" href="{{ company.main_phone }}">{{ company.main_phone }} </a></td>

        </tr>
        {% endif %}

        <tr>
            <td>Products:</td>
            <td  id="company-product">{{ company.product }}</td >
            <td>Applications:</td>
            <td data-type="text" data-model="Company" data-url="/formfields/Company/{{ company.id }}/applications/" data-pk="{{ company.id }}"  data-title="Company Applications" id="company-applications">{{ company.applications }}</td>
        </tr>
        <tr>
            <td>Related Categories:</td>
            <td colspan="3" data-type="text" data-model="Company" data-url="/formfields/Company/{{ company.id }}/applications/" data-pk="{{ company.id }}"  data-title="Company Applications" id="company-tags"> {{ company.tags }}</td>

        </tr>

    </tbody>

</table>

</div>

<div>
<div class="media">
    <h4 class="media-heading"><strong class="muted">Overview:</strong></h4>
    <p data-type="text" data-model="Company" data-url="/formfields/Company/{{ company.id }}/overview/" data-pk="{{ company.id }}"  data-title="Company Overview" id="company-overview">{{ company.overview  }}</p>
</div>
<div class="media">
    <h4 class="media-heading"><strong class="muted">Related Industries:</strong></h4>
    <p class="editables" data-type="text" data-model="Company" data-url="/formfields/Company/{{ company.id }}/industries/" data-pk="{{ company.id }}"  data-title="Company Industries" id="company-industries">{{ company.industries }}</p>

    {% load humanize %}

    {% if  user.is_staff or user.is_superuser or permission %}

        {############################################## Customers ###################################}
        <div class="media">


                <h4 class="media-heading"><strong class="muted">Customers:</strong></h4></br>
                <ul class="nav nav-list pull-right">
                    <li><a class="add-element editables" data-model="Customer" href="/company/{{ company.slug }}/customers/new"><i class="icon-plus"></i> Add Customers</a></li>
                </ul>

                <br/>
                <ul class="pull-left inline" id="Customer">
                {% for customer in customers  %}

                        <li id="customers-{{ customer.id }}"><a class="link-delete" data-type="customers" data-id="{{ customer.id }}"  id="{{ company.slug }}-customers-{{ customer.id }}" href="/company/{{ company.slug }}/customers/{{customer.id}}/delete" ><i class="icon-remove"></i></a>  <a href="/company/{{ company.slug }}/customers/{{customer.id}}/update">{{ customer.name }}</a>{% if not forloop.last %}, {% endif %}</li>
                {% endfor %}
                </ul>
        </div>

                {############################################## Awards ##############################}

        <div class="media">


            <h4 class="media-heading"><strong class="muted">Awards:</strong></h4></br>
            <ul class="nav nav-list pull-right">
                <li><a class="add-element" data-model="Award" href="/company/{{ company.slug }}/awards/new"><i class="icon-plus"></i> Add award</a></li>
            </ul>

            <br/>
            <ul class="pull-left inline">
            {% for award in awards  %}

                    <li id="awards-{{ award.id }}"><a class="link-delete" data-type="awards" data-id="{{ award.id }}" id="{{ company.slug }}-awards-{{ award.id }}"  href="/company/{{ company.slug }}/awards/{{award.id}}/delete"><i class="icon-remove"></i></a>  <a href="/company/{{ company.slug }}/awards/{{award.id}}/update">{{ award.name }}</a> {% if not forloop.last %}, {% endif %}</li>

            {% endfor %}
            </ul>
        </div>

        {############################################## Certifications ##############################}
        <div class="media">
            <h4 class="media-heading"><strong class="muted">Certifications:</strong></h4></br>
            <ul class="nav nav-list pull-right">
                <li><a class="add-element" data-model="Certification" href="/company/{{ company.slug }}/certifications/new"><i class="icon-plus"></i> Add Certification</a></li>
            </ul>

            <br/>
            <ul class="pull-left inline">
            {% for certification in certifications  %}

                    <li id="certifications-{{ certification.id }}"><a class="link-delete" data-type="certifications" data-id="{{ certification.id }}" id="{{ company.slug }}-certifications-{{ certification.id }}"  href="/company/{{ company.slug }}/certifications/{{certification.id}}/delete"><i class="icon-remove"></i></a>  <a href="/company/{{ company.slug }}/certifications/{{certification.id}}/update">{{ certification.name }}</a> {% if not forloop.last %}, {% endif %}</li>

            {% endfor %}
            </ul>
        </div>

    {% else %}

            {############################################## Customers #####################################}
        <div class="media">
            <h4 class="media-heading"><strong class="muted">Customers:</strong></h4>

            <ul class="pull-left inline">
            {% for customer in customers  %}

                    <li>{{ customer.name }}</li>{% if not forloop.last %}, {% endif %}


            {% endfor %}
        </div>

        {############################################## Awards #####################################}
        <div class="media">
            <h4 class="media-heading"><strong class="muted">Awards:</strong></h4>
            <ul class="pull-left inline">
            {% for award in awards  %}
                    <li>{{ award.name }}{% if not forloop.last %}, {% endif %}</li>

            {% endfor %}
            </ul>
        </div>

        {############################################## Certifications #####################################}
        <div class="media">
            <h4 class="media-heading"><strong class="muted">Certifications:</strong></h4>

            <ul class="pull-left inline">
            {% for certification in certifications  %}

                    <li>{{ certification.name }}</li>{% if not forloop.last %}, {% endif %}


            {% endfor %}
        </div>


    {% endif %}


</div>

<div class="media">
    <h4 class="media-heading"><strong class="muted">Technologies:</strong></h4>
    <p id="company-technologies">{{ company.technologies }}</p>
</div>


    {% if  user.is_staff or user.is_superuser or permission %}


        {####################################### Funding #####################################}
    <div class="media">
        <h4 class="media-heading"><strong class="muted">Funding:</strong></h4>
        <br/>

            <ul class="nav nav-list pull-right">
                <li><a class="add-element" data-model="Funding" href="/company/{{ company.slug }}/fundings/new"><i class="icon-plus"></i> Add Funding</a></li>
            </ul>


            {% for funding in fundings %}
                <li id="fundings-{{ funding.id }}"><a class="link-delete" data-type="fundings" data-id="{{ funding.id }}" id="{{ company.slug }}-fundings-{{ funding.id }}"  href="/company/{{ company.slug }}/fundings/{{funding.id}}/delete"><i class="icon-remove"></i></a>  <a href="/company/{{ company.slug }}/fundings/{{funding.id}}/update">{{ funding.round }}</a> {% if not forloop.last %}{% endif %}
                 <p> US$ {{ funding.raised|intcomma}}</p>
                 </li>


            {% endfor %}
        </br>
    </div>



        {############################################## Acquisition ####################################}
        <div class="media">


                <h4 class="media-heading"><strong class="muted">Acquisitions:</strong></h4></br>
                <ul class="nav nav-list pull-right">
                    <li><a class="add-element" data-model="Acquisition" href="/company/{{ company.slug }}/acquisitions/new"><i class="icon-plus"></i> Add Acquisitions</a></li>
                </ul>

                <br/>
                <ul class="pull-left inline">
                {% for acquisition in acquisitions  %}

                    <li id="acquisitions-{{ acquisition.id }}"><a class="link-delete" data-type="acquisitions" data-id="{{ acquisition.id }}" id="{{ company.slug }}-acquisitions-{{ acquisition.id }}" href="/company/{{ company.slug }}/acquisitions/{{acquisition.id}}/delete"><i class="icon-remove"></i></a>  <a href="/company/{{ company.slug }}/acquisitions/{{acquisition.id}}/update">{{ acquisition.name }}</a>{% if not forloop.last %}, {% endif %}</li>
                {% endfor %}
                </ul>
        </div>

        {####################################### Management #####################################}
    <div class="media">
    <h4 class="media-heading"><strong class="muted">Management:</strong></h4>
    <br/>

        <ul class="nav nav-list pull-right">
            <li><a class="add-element" data-model="Management" href="/company/{{ company.slug }}/management/new"><i class="icon-plus"></i> Add Manager</a></li>
        </ul>


        {% for manager in management %}
            <ul id="management-{{ manager.id }}" class="nav nav-list pull-left">
                <li><a class="link-delete" data-type="management" data-id="{{ manager.id }}" id="{{ company.slug }}-management-{{ manager.id }}" href="/company/{{ company.slug }}/management/{{manager.id}}/delete"><i class="icon-remove"></i></a></li>

            <h5 class="media-heading text-info"> <a href="/company/{{company.slug }}/management/{{ manager.id }}/update">{{ manager.full_name }}</a></h5>
                <p> {{ manager.title }}</p>
            </ul>

        {% endfor %}
    </br>
    </div>


        {############################################## Offices ##############################}

    <div class="media">

    <h4 class="media-heading"><strong class="muted">Offices:</strong></h4>
        <ul class="nav nav-list pull-right">
            <p id="company-offices">{{ offices.description }}</p>
            <li><a class="add-element" data-model="Office" href="/company/{{ company.slug }}/office/new"><i class="icon-plus"></i> Add Office</a></li>
        </ul>
        <ul class="pull-left inline">
            {% for office in offices %}
             <li  id="office-{{ office.object.id }}" >
                <a class="link-delete pull-left" data-type="office" data-id="{{ office.object.id }}" id="{{ company.slug }}-office-{{ office.object.id }}" href="/company/{{ company.slug }}/office/{{ office.object.id }}/delete"><i class="icon-remove"></i></a>
                <address>
                    <strong><a href="/company/{{company.slug }}/office/{{ office.object.id }}/update">{{ office.object.country }}</a></strong><br>
                    {{ office.object.description }}<br>
                    {{ office.object.address_1 }}<br>
                    {{ office.object.address_2 }}<br>
                    {% if office.object.phone %}
                      <abbr title="Phone">P:</abbr> {{ office.object.phone }}<br>
                    {% endif %}

                {% if office.ul  %}
                    </ul><br>

                    <ul class="pull-left inline">
                {% endif %}
            {% endfor %}
        </ul><br>
    </div>

        {############################################## Competitors ##############################}

    <div class="media">
        <h4 class="media-heading"><strong class="muted">Competitors:</strong></h4>
        <ul class="nav nav-list pull-right">
            <li><a class="add-element" data-model="Competitor" href="/company/{{ company.slug }}/competitors/new"><i class="icon-plus"></i> Add Competitor</a></li>
        </ul>

        <br/>
        <ul class="pull-left inline">
        {% for competitor in competitors  %}

                <li id="competitors-{{ competitor.id }}"><a class="link-delete" data-type="competitors" data-id="{{ competitor.id }}" id="{{ company.slug }}-competitors-{{ competitor.id }}" href="/company/{{ company.slug }}/competitors/{{competitor.id}}/delete"><i class="icon-remove"></i></a>  <a href="/company/{{ company.slug }}/competitors/{{competitor.id}}/update">{{ competitor.name }}</a> {% if not forloop.last %}, {% endif %}</li>

        {% endfor %}
        </ul>
    </div>

        {############################################## Pictures ####################################}
        <div class="media">


                <h4 class="media-heading"><strong class="muted">pictures:</strong></h4></br>
                <ul class="nav nav-list pull-right">
                    <li><a class="add-element" data-model="Picture" href="/company/{{ company.slug }}/pictures/new"><i class="icon-plus"></i> Add pictures</a></liic                </ul>

                <br/>
                <ul class="thumbnails pull-left inline">
                  <div class="row-fluid">

                {% for picture in pictures  %}


                        <li id="pictures-{{ picture.id }}" class="span2" > <a class="link-delete" data-type="pictures" data-id="{{ picture.id }}" id="{{ company.slug }}-pictures-{{ picture.id }}" onclick="{{ company.slug }}_pictures_{{ picture.id }}(); return false;" href="/company/{{ company.slug }}/pictures/{{ picture.id }}/delete"><i class="icon-remove"></i></a>  <a class="gallery" href="{{ MEDIA_URL }}{{ picture.file}}" > <img  data-src="holder.js/160x120" src="{{ MEDIA_URL }}{{ picture.file}}" width="160" height="160"> </a></li>

                    <script>
                    function {{ company.slug }}_pictures_{{ picture.id }}(){
                        var r = confirm("Are You sure You want to delete picture {{ picture.name }}");
                        if( r == true){
                            return document.location.href = "/company/{{ company.slug }}/pictures/{{picture.id}}/delete";
                        }else{
                            return false;
                        }
                    }
                    </script>

                {% endfor %}
                    <br><br>

                    </div>

                </ul>
        </div>

    {% else %}

    {####################################### Funding #####################################}
    <div class="media">
        <h4 class="media-heading"><strong class="muted">Funding:</strong></h4>

            {% for funding in fundings %}
                <h5 class="media-heading text-info "> {{ funding.round }}</a></h5>
                    <p> US$ {{ funding.raised|intcomma}}</p>

            {% endfor %}
        </br>
    </div>
        {####################################### Management #####################################}

            <div class="media">
            <h4 class="media-heading"><strong class="muted">Management:</strong></h4>

        {% for manager in management %}
            <h5 class="media-heading text-info"> {{ manager.full_name }}</h5>
                <p> {{ manager.title }}</p>

        {% endfor %}



        {############################################## Competitors #####################################}
        <div class="media">
            <h4 class="media-heading"><strong class="muted">Acquisitions:</strong></h4>
            <ul class="pull-left inline">
            {% for acquisition in acquisitions  %}
                    <li>{{ acquisition.name }}{% if not forloop.last %}, {% endif %}</li>

            {% endfor %}
            </ul>
        </div>
        {############################################## Offices #####################################}

        <div class="media">
            <h4 class="media-heading"><strong class="muted">Offices:</strong></h4>
            <ul class="nav nav-list pull-right">
                <p id="company-offices">{{ offices.description }}</p>
            </ul>
            <ul class="pull-left inline">
                {% for office in offices %}
                 <li>
                    <address>
                        <strong>{{ office.object.country }}</strong><br>
                        {{ office.object.description }}<br>
                        {{ office.object.address_1 }}<br>
                        {{ office.object.address_2 }}<br>
                   <address>
                </li>

                    {% if office.ul  %}
                        </ul><br>

                        <ul class="pull-left inline">
                    {% endif %}
                {% endfor %}
            </ul><br>
        </div>

        {############################################## Competitors #####################################}
        <div class="media">
            <h4 class="media-heading"><strong class="muted">Competitors:</strong></h4>
            <ul class="pull-left inline">
            {% for competitor in competitors  %}
                    <li>{{ competitor.name }}{% if not forloop.last %}, {% endif %}</li>

            {% endfor %}
            </ul>
        </div>
        {############################################## Pictures #####################################}

        <div class="media">
            <h4 class="media-heading"><strong class="muted">Pictures: </strong></h4>
            <ul class="thumbnails pull-left inline">
                <div class="row-fluid">

            <br>

            {% if pictures %}

                    {% for picture in pictures %}
                    <li class="span2"> <a class="gallery" href="{{ MEDIA_URL }}{{ picture.file}}"><img src="{{ MEDIA_URL }}{{ picture.file}}"></a></li>
                    {% endfor %}

            {% endif %}
                </div>
            </ul>
        </div>
    {% endif %}
    <div class="media">
    <h4 class="media-heading"><strong class="muted">Latech Contact:</strong></h4>
    <p id="company-contact">{{ company.contact }}</p>

</div>

</div>
</div>
<!--#    project = models.ManyToManyField("Project")

#    links = models.ForeignKey("URLs") -->

<div id="companyModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <h3 id="myModalLabel">Login</h3>
    </div>
    <div class="modal-body">
            <div class="alert alert-success hide" id="success-notification">
              <button type="button" class="close" data-dismiss="alert">&times;</button>
              Congratulations! The new <strong id="succes-model"></strong> has been created on the database
            </div>
            <div class="alert alert-block alert-error hide" id="error-notification">
              <button type="button" class="close" data-dismiss="alert">&times;</button>
              Warning! The <strong id="error-model"></strong> element was not created in the database due to the following fields:

              <ul id="error-list">
              </ul>
              Please verify the fields and fill them corretly.
            </div>
            <form id="new-form" method="POST" action="/login/" >
                {% csrf_token %}
                <div class="modal-form" data-model="0" >
                </div>
                <a href="#"  id="create-item"  class="btn btn-primary"  >Create</a>
                <a href="#"  id="add-another"  class="btn btn-info" >Create and Add another</a>
                <a href="#" id="cancel-modal" class="btn btn-inverse">Cancel</a>

            </form>
    </div>
    <div class="modal-footer">
    </div>
    </div>
        <script type="text/javascript">
            
            //select all the links with the function or class delete
           var link = $(".link-delete");

link.click(
    function(event){
        //eliminate the default function
        event.preventDefault();
        //get the data from the link when clicked; data = ["type_deletion","id","company_name"]*company comes by default
        
        
        var r = confirm("Are You sure You want to delete this item?");
        if( r == true){
            //pass the data to the ajax function to call the server
            var data_type = $(this).data("type");
            var id = $(this).data("id");
            var company_name = "{{ company.slug }}";
            $.ajax({
                url: "/company/"+company_name+"/"+data_type+"/"+id+"/delete",
                success: 
                    function(result){
                        $("#"+data_type+"-"+id).remove();  
                    },
                error: 
                    function(){
                        alert("We are experiencing problems wit error, please try again later");
                    }
            });

    }else{
        return false;
    }});


    var add = $(".add-element");

add.click(
        function(event){
            var model = $(this).data("model");  
            var id = $(this).data("id"); //can be form_id
            event.preventDefault();

            $.ajax({
                url: "/forms/"+model+"/",
                data: { 'csrfmiddlewaretoken': '{{csrf_token}}' }, 
                type: "POST",
                cache: false,

                success: 
                    function(result){
                        $("#myModalLabel").html("Create a new "+ model +".");
                        $("#success-notification").addClass("hide");
                        $(".modal-form").html(result);
                        $(".modal-form").data("model", model);
                        $("#companyModal").modal("show");
                        $('#id_date').datepicker();
                        $('#id_acquired_date').datepicker();
                    },
                error: 
                    function(xhr){
                        alert("Error: " + xhr.statusText);
                        //alert("We are experiencing problems with the server , please try again later");
                        return false;
                    }
            });
            
        });

    var add_another = $('#add-another');
add_another.click( 
        function(event){

            var model_name = $(".modal-form").data("model");
            event.preventDefault();
            $.ajax({
                url: "/forms/{{ company.slug }}/"+model_name+"/",
                type: "POST",
                cache: false,
                data:  $('#new-form').serialize(), 
                success: 
                    function(result){
                        alert(result);
                        $.ajax({
                            url: "/forms/"+model_name+"/",
                            data: { 'csrfmiddlewaretoken': '{{csrf_token}}' }, 
                            type: "POST",
                            dataType: 'json',
                            cache: false,
                            success:
                                function(json){
                                    if(json.errors !== undefined){
                                        alert("Errors in the forms");

                                    }else{
                                       $("#succes-model").html(model_name); 
                                       $("#success-notification").removeClass("hide"); 
                                       $(".modal-form").trigger('reset');
                                    }},
                            error: 
                                function(xhr){
                                    alert("Error: " + xhr.statusText);
                                    //alert("We are experiencing problems with the server , please try again later");
                                    return false;
                                },
                            });
                    },
                error: 
                    function(xhr){
                        alert("Error 2: " + xhr.statusText);
                        //alert("We are experiencing problems with the server , please try again later");
                        return false;
                    }
            });
        });

    var modal_btn = $('#modal-btn');
    modal_btn.click( 
        function(event){

            event.preventDefault();
            $.ajax({
                url: "/forms/{{ company.slug }}/"+model+"/",
                type: "POST",
                cache: false,
                data: { 'csrfmiddlewaretoken': '{{csrf_token}}' }, 
                success: 
                    function(result){
                        alert("Success");
                    },
                error: 
                    function(xhr){
                        alert("Error: " + xhr.statusText);
                        //alert("We are experiencing problems with the server , please try again later");
                        return false;
                    }
            });
        })

    var cancel_modal = $("#cancel-modal");

    cancel_modal.click(
        function(event){
            event.preventDefault();
            $("#companyModal").modal("hide");
        });

    var create_item = $('#create-item');
create_item.click( 
        function(event){

            var model_name = $(".modal-form").data("model");
            event.preventDefault();
            $.ajax({
                url: "/forms/{{ company.slug }}/"+model_name+"/",
                type: "POST",
                cache: false,
                data:  $('#new-form').serialize(), 
                success: 
                    $("#companyModal").modal("hide")
                    ,
                error: 
                    function(xhr){
                        alert("Error: " + xhr.statusText);
                        //alert("We are experiencing problems with the server , please try again later");
                        return false;
                    }
            });
        })


        </script>
    <link href="{{ STATIC_URL }}bootstrap-editable/css/bootstrap-editable.css" rel="stylesheet">
    <script src="{{ STATIC_URL }}bootstrap-editable/js/bootstrap-editable.js"></script>
    <script src="{{ STATIC_URL }}js/moment.min.js"></script>
    
    <script type="text/javascript">
    $.fn.editable.defaults.mode = 'inline';
        $('.editables').editable();

        $('#company-value-proposition').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });

        $('#company-description').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });

        $('#company-url').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });

        $('#company-blog-url').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });


        $('#company-twitter-url').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });

        $('#company-phone').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });


        $('#company-facebook-url').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });
        $('#company-email').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });
        $('#company-tags').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });
        $('#company-applications').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });

        $('#company-overview').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });
        $('.editables').editable({
            params: function(params) {
                //originally params contain pk, name and value
                params.csrfmiddlewaretoken = '{{csrf_token}}';
                return params;
            },
        });


</script>

{% endblock %}
</div>
