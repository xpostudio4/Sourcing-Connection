{% extends "base.html" %}

{% block title %}{{ company.name  }}{% endblock %}
{% block external %}
<script>
       $(document).ready(function(){

       	//A list of all the classes and Id's of the elements to be treated as read only tags.
       	var tag_ids  = ['#company-product','#company-certification', '#company-industries', '#company-customers', '#company-offices', '#company-tags', '#company-applications', '#company-technologies']; 



       	//for(i in tag_ids){

       		//Create read only tags for the degrees field
       		//var degrees =  $(this).find(tag_ids[i]).html().split(",");
       		//var string_degrees = ""; 


        	//for( j  in degrees){
       		//	string_degrees += "<code>" + degrees[j] + "</code>  ";
       		//}

       		//$(tag_ids[i]).html(string_degrees);

       	//}
       	//Obtain twitter name and prettify it for the profile
       	var twitter_name  = $(this).find('#company-twitter-url').text().split("/").pop();
       		$('#company-twitter-url').text("@"+twitter_name);
       		
      	 	
       
       	//Obtain the facebook profile name.
       	var facebook_name  = $(this).find('#company-facebook-url').text().split("/").pop();
       	$('#company-facebook-url').text(facebook_name)


       })
</script>
{% endblock %}

{% block content %}
<br/>
		{% if percentage_profile %}
			<h2 class="pagination-centered">Profile {{ percentage_profile.percentage }}% complete</h2>
			<div class="percentage-box ">
				
			   <div class="progress span5">

			   		<div class="bar" style="width: {{ percentage_profile.percentage }}%;"></div>
			   </div>
			</div>



		{% endif %}
		<br/>


		{% if  user.is_staff or user.is_superuser or permission %}
	        
				<div class="pull-right" style="margin-right:80px;">
					<button type="button" class="btn btn-primary" data-toggle="button" ONCLICK="window.location.href='/company/{{ company.slug }}/update'">  Edit  </button>
				</div>
 		 
		{% endif %}
<br/>
		
		<div class="media">
			<a class="pull-left" href="#">
				{% if company.logo %}
	
				<img class="img-polaroid" data-src="holder.js/64x64" src="{{ MEDIA_URL }}{{ company.logo }}" height="130", width="178">
				{% else %}
				<img class="img-polaroid" data-src="holder.js/64x64" src="{{ STATIC_URL }}images/no_logo.png" height=96, width=140  >
				
				{% endif %}
	 		</a>
	 	<div class="pull-right" style="margin-right:80px;"> 
	 	<div class="btn-group">
        	<button class="btn">Follow</button>
  				<button class="btn dropdown-toggle" data-toggle="dropdown">
   				<span class="caret"></span>
  			</button>
  			<ul class="dropdown-menu">
    			<li><a tabindex="-1" href="#">Contact Company</a></li>
				<li><a tabindex="-1" href="#">Follow Blog</a></li>
				<li class="divider"></li>
				<li><a tabindex="-1" href="#">Something else here</a></li>
 			</ul>
         </div>
    	</div>
     <div class="media">
		<h2 class="media-heading">{{ company.name  }} </h2>
		<p class="muted">{{ company.value_proposition  }}</p>
         
	</div>
	<div class="span10">
		
		
     	
    	<div class="media">
			<h4 class="media-heading"><strong class="muted">Company Description:</strong></h4>
			<p> {{ company.description  }}</p>
     	</div>
	
	<div class="media">
<table class="table">
	<tbody>
		<tr>
			<td>Company Link:</td>
			<td><a href="{{ company.web_url }}">{{ company.web_url }}</a></td>
			<td>Company Blog:</td>
			<td><a href="{{ company.blog_url  }}">{{ company.blog_url  }}</a></td>
		</tr>
		<tr>
			<td>Twitter:</td>
			<td >{% if  company.twitter_url  %}<a href="{{ company.twitter_url  }}" id = "company-twitter-url" >{{ company.twitter_url  }}</a>{% endif %}</td>
			
			<td>Facebook:</td>
			<td ><a href="{{ company.facebook_link  }}" id="company-facebook-url">{{ company.facebook_link  }}</a></td>
		</tr>
		{% if  user.is_staff or user.is_superuser or permission %}
		<tr>
			<td>Email: </td>
			<td><a href="mailto:{{ company.email  }}">{{ company.email  }} </a></td>
			<td>Phone Contact:</td>
			<td>{{ company.main_phone }}</td>
		</tr>
		{% endif %}
		<tr>
			<td>Products:</td>
			<td  id="company-product">{{ company.product }}</td>
			<td>Certifications:</td>
			<td id="company-certification"> {{ company.certification }}</td>
		</tr>
		<tr>
			<td>Related Categories:</td>
			<td id="company-tags">{{ company.tags }}</td>
			<td>Applications:</td>
			<td id="company-applications">{{ company.applications }}</td>
		</tr>

	</tbody>

</table>
			
</div>

<div>
<div class="media">
	<h4 class="media-heading"><strong class="muted">Overview:</strong></h4>
	<p id="company-overview">{{ company.overview  }}</p>
</div>
<div class="media">
	<h4 class="media-heading"><strong class="muted">Related Industries:</strong></h4>
	<p id="company-industries">{{ company.industries }}</p>

</div>

<div class="media">
	<h4 class="media-heading"><strong class="muted">Technologies:</strong></h4>
	<p id="company-technologies">{{ company.technologies }}</p>
</div>


<div class="media">
	<h4 class="media-heading"><strong class="muted">Funding:</strong></h4>
	<p id="#company-funding">{{ company.funding }}</p>

</div>

<div class="media">
	<h4 class="media-heading"><strong class="muted">Offices:</strong></h4>
		<ul class="nav nav-list pull-right">
			<p id="company-offices">{{ offices.description }}</p>
			<li><a href="/company/{{ company.slug }}/office/new"><i class="icon-plus"></i> Add Office</a></li>
		</ul>
		<ul class="pull-left inline">
			{% for office in offices %}
			 <li>
			 	<address>
			 		<strong><a href="/company/{{company.slug }}/office/{{ office.object.id }}/update">{{ office.object.country }}</a></strong><br>
			 		{{ office.object.description }}<br>			
			  		{{ office.object.address_1 }}<br>
				    {{ office.object.address_2 }}<br>
				   	{% if office.object.phone %}
				      <abbr title="Phone">P:</abbr> {{ office.object.phone }}<br>
				   	{% endif %}
			   </address>
			</li>

	        	{% if office.ul  %}
			        </ul><br>
			        
			        <ul class="pull-left inline">
		        {% endif %}    
	   		{% endfor %}
		</ul><br>
		
</div>

<div class="media">
	<h4 class="media-heading"><strong class="muted">Management:</strong></h4>
	<br/>

	{% if  user.is_staff or user.is_superuser or permission %}
		<ul class="nav nav-list pull-right">
			<li><a href="/company/{{ company.slug }}/management/new"><i class="icon-plus"></i> Add Manager</a></li>
		</ul>

		{####################################### Management #####################################}
		{% for manager in management %}
			<ul class="nav nav-list pull-left">
				<li><a id="{{ company.slug }}-management-{{ manager.id }}" onclick="{{ company.slug }}_management_{{ manager.id }}(); return false;" href="/company/{{ company.slug }}/management/{{manager.id}}/delete"><i class="icon-remove"></i></a></li>
		</ul>
		<script>
		function {{ company.slug }}_management_{{ manager.id }}(){
			var r = confirm("Are You sure You want to delete Manager {{ manager.full_name }}");
			if( r == true){
				return document.location.href = "/company/{{ company.slug }}/management/{{manager.id}}/delete";
			}else{
				return false;
			}
		}
		</script>
			<h5 class="media-heading text-info"> <a href="/company/{{company.slug }}/management/{{ manager.id }}/update">{{ manager.full_name }}</a></h5>
				<p> {{ manager.title }}</p>

		{% endfor %}
	</br>

		{############################################## Competitors ##############################}
		<h4 class="media-heading"><strong class="muted">Competitors:</strong></h4></br>
		<ul class="nav nav-list pull-right">
			<li><a href="/company/{{ company.slug }}/competitors/new"><i class="icon-plus"></i> Add Competitor</a></li>
		</ul>

		<br/>
		<ul class="pull-left inline">
		{% for competitor in competitors  %}
		
				<li><a id="{{ company.slug }}-competitors-{{ competitor.id }}" onclick="{{ company.slug }}_competitors_{{ competitor.id }}(); return false;" href="/company/{{ company.slug }}/competitors/{{competitor.id}}/delete"><i class="icon-remove"></i></a>  <a href="/company/{{ company.slug }}/competitors/{{competitor.id}}/update">{{ competitor.name }}</a></li>{% if not forloop.last %}, {% endif %}
		
		<script>
		function {{ company.slug }}_competitors_{{ competitor.id }}(){
			var r = confirm("Are You sure You want to delete Competitor {{ manager.name }}");
			if( r == true){
				return document.location.href = "/company/{{ company.slug }}/competitors/{{competitor.id}}/delete";
			}else{
				return false;
			}
		}
		</script>
			
		{% endfor %}	
		</ul>


	{% else %}
		{% for manager in management %}
			<h5 class="media-heading text-info"> {{ manager.full_name }}</h5>
				<p> {{ manager.title }}</p>

		{% endfor %}

		{############################################## Competitors #####################################}
		<div class="media">
		<h4 class="media-heading"><strong class="muted">Competitors:</strong></h4>
		<ul class="pull-left inline">
		{% for competitor in competitors  %}
				<li>{{ competitor.name }}{% if not forloop.last %}, {% endif %}</li>

		{% endfor %}
		</ul>
		</div>

		<div class="media">
	<h4 class="media-heading"><strong class="muted">Offices:</strong></h4>
		<ul class="nav nav-list pull-right">
			<p id="company-offices">{{ offices.description }}</p>
			<li><a href="/company/{{ company.slug }}/office/new"><i class="icon-plus"></i> Add Office</a></li>
		</ul>
		<ul class="pull-left inline">
			{% for office in offices %}
			 <li>
			 	<address>
			 		<strong>{{ office.object.country }}</strong><br>
			 		{{ office.object.description }}<br>			
			  		{{ office.object.address_1 }}<br>
				    {{ office.object.address_2 }}<br>
			   <address>
			</li>

	        	{% if office.ul  %}
			        </ul><br>
			        
			        <ul class="pull-left inline">
		        {% endif %}    
	   		{% endfor %}
		</ul><br>

		
	{% endif %}

</div>
</div>
<!--#    project = models.ManyToManyField("Project")

#    links = models.ForeignKey("URLs") -->

<div class="media">
	<h4 class="media-heading"><strong class="muted">Latech Contact:</strong></h4>
	<p id="company-contact">{{ company.contact }}</p>

</div>
{% if pictures %}
	{% for picture in pictures %}
		<a><img src="{{ MEDIA_URL }}/{{ picture.file}}"></a>

	{% endfor %}
{% endif %}
<p> </p>

{% endblock %}
</div>
